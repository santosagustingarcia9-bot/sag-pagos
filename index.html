<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAG & SK - Payment</title>

<script src="https://sdk.mercadopago.com/js/v2"></script>

<style>
body{
  background:#f5f5f5;
  font-family:Arial, sans-serif;
}

.container{
  max-width:400px;
  margin:40px auto;
  background:white;
  padding:25px;
  border-radius:15px;
  box-shadow:0 4px 20px rgba(0,0,0,0.1);
}

h2{
  text-align:center;
  margin-bottom:20px;
}

.resumen{
  display:flex;
  justify-content:space-between;
  background:#eee;
  padding:10px 15px;
  border-radius:8px;
  margin-bottom:20px;
}

.card{
  background:white;
  border:2px solid #ddd;
  padding:20px;
  border-radius:12px;
  text-align:center;
  margin-bottom:15px;
}

.card.mp{
  cursor:pointer;
}

.cards-icons img{
  width:40px;
  margin:5px;
}

input{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:15px;
}

.btn{
  width:100%;
  padding:15px;
  background:linear-gradient(90deg,#7b4dff,#6a11cb);
  color:white;
  border:none;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="container">

  <h2>SAG & SK</h2>

  <div class="resumen">
    <span>Combinada del día</span>
    <strong>$ 5000 ARS</strong>
  </div>

  <!-- MERCADOPAGO -->
  <div class="card mp" onclick="pagarMP()">
    <img src="https://www.mercadopago.com/org-img/MP3/home/logomp3.gif" width="120">
    <p>Pagar con MercadoPago</p>
  </div>

  <!-- TARJETAS -->
  <div class="card">
    <div class="cards-icons">
      <img src="https://img.icons8.com/color/48/visa.png"/>
      <img src="https://img.icons8.com/color/48/mastercard.png"/>
      <img src="https://img.icons8.com/color/48/amex.png"/>
    </div>
    <p>Pagar con tarjeta débito o crédito</p>
  </div>

  <!-- FORMULARIO -->
  <form id="card-form">

    <input type="text" id="cardholderName" placeholder="Nombre completo" required>

    <input type="text" id="cardNumber" placeholder="Número de tarjeta" required>

    <input type="text" id="expiry" placeholder="MM/AA" required>

    <input type="text" id="cvv" placeholder="CVV" required>

    <button type="submit" class="btn">
      Confirmar pago
    </button>

  </form>

</div>

<script>
const mp = new MercadoPago("APP_USR-972156396504445-022116-fc7298fee8a785f65f6b31b5550fb9ac-3217662202");

// Abrir checkout MercadoPago
async function pagarMP(){
  const response = await fetch("/crear-preferencia", {
    method:"POST"
  });
  const data = await response.json();

  mp.checkout({
    preference:{ id:data.id },
    autoOpen:true
  });
}

/* SOLO NUMEROS TARJETA (max 16) */
document.getElementById("cardNumber").addEventListener("input", function(){
  this.value = this.value.replace(/\D/g,"").slice(0,16);
});

/* FORMATO MM/AA */
document.getElementById("expiry").addEventListener("input", function(){
  this.value = this.value.replace(/\D/g,"");

  if(this.value.length >= 3){
    this.value = this.value.slice(0,2) + "/" + this.value.slice(2,4);
  }

  if(this.value.length > 5){
    this.value = this.value.slice(0,5);
  }
});

/* SOLO NUMEROS CVV (max 4) */
document.getElementById("cvv").addEventListener("input", function(){
  this.value = this.value.replace(/\D/g,"").slice(0,4);
});

/* ENVIO TARJETA */
document.getElementById("card-form").addEventListener("submit", async function(e){
  e.preventDefault();

  alert("Para procesar tarjeta real necesitas CardForm oficial.");
});
</script>

</body>
  </html>
